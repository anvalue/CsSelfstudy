## 中断系统

> 处理随机发生事件

### 1. 什么是中断系统

- 基本解释：

  - 计算机CPU执行某程序事，发生了紧急事件或有特殊请求，CPU暂停某程序的执行，转而去处理上述事件或请求，处理完毕后再重新执行某程序的过程叫中断

    > 例1：用电脑播放电影，用鼠标双击浏览器，CPU收到鼠标的请求，暂停处理视频文件，转而处理鼠标，然而我们CPU处理很快，很快处理完事件，所以视频也没有发生卡顿现象
    >
    > 如果不存在中断，即不能多任务处理，要先暂停播放电影才能双击鼠标的浏览器
    >
    > 例2：![](https://gitee.com/constsheng/imgcurl/raw/master/img/20210323163630.png)

- 中断服务函数：内核响应中断后执行的相应处理程序
- 中断向量：中断服务程序的入口地址。每个中断源都对应一个固定的入口地址。当内核响应中断请求时，就会暂停当前的程序执行，然后跳转到该入口地址执行代码



### 2. 中断系统在单片机系统中的作用

> 51单片机有5个中断源(忽略定时/计数器2)，分2个优先级，中断源按从高到低为：
>
> ![](https://gitee.com/constsheng/imgcurl/raw/master/img/20210507200111.png)

### 2.1 中断系统结构

![](https://gitee.com/constsheng/imgcurl/raw/master/img/20210507200203.png)

### 2.2 中断源入口

每个中断源的固定入口地址：

![](https://gitee.com/constsheng/imgcurl/raw/master/img/20210507200253.png)

### 2.3 中断相关寄存器

> 中断相关寄存器有4个，每个寄存器都是可以位寻址的。

其中2个为控制寄存器：IE寄存器与IP寄存器

![](https://gitee.com/constsheng/imgcurl/raw/master/img/20210507200538.png)

另外2个为中断请求标志：TCON寄存器与SCON寄存器：

![](https://gitee.com/constsheng/imgcurl/raw/master/img/20210507200705.png)

### 3. 如何去使用单片机的中断系统

![](https://gitee.com/constsheng/imgcurl/raw/master/img/20210507200813.png)

### 3.1 初始化中断源

```cpp
// 这里以初始化定时/计数器T0位例
void Init_T0()
{
    
}
```



### 3.2 中断服务函数：

```c
// 这里以定时计数器T0为例

//=============声明===========
void Service_T0();
//===========================

//=============定义===========
void Service_T0() interrupt 1
{
    //代码省略
}
//===========================
```



